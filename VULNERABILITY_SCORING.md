# Vulnerability Scoring Methodology

## Overview

The vulnerability score is a strategic metric designed for political analysis, indicating how susceptible a race is to flipping or losing. Higher scores indicate greater risk.

**Score Range:** 0-100 (higher = more vulnerable)

## Scoring Components

The vulnerability score is calculated as a weighted composite of four strategic factors:

### 1. Margin Tightness (40% weight)

The most significant factor. Measures how close the race outcome was.

- **Formula:** 100 × (1 - margin_pct/50) with emphasis boost for races <5%
- **Logic:** Races with 1% margin are fundamentally more vulnerable than races with 20% margin
- **Emphasis boost:** Races under 5% margin get a 1.3x multiplier to emphasize truly competitive races
- **Range:** 0-100

**Examples:**
- 0.5% margin → ~100 (vulnerable)
- 5% margin → ~78 (very vulnerable after boost)
- 20% margin → ~60 (moderate)
- 50% margin → 0 (safe)

### 2. Swing Potential (30% weight)

Measures how many votes would need to change to flip the outcome.

- **Formula:** (margin_pct / 5) × 100 capped at 100
- **Logic:** Smaller margins represent fewer votes in dispute, making swings more likely
- **Range:** 0-100 (maxes out at 5% margin)

**Examples:**
- 1% margin → 20 swing potential
- 5% margin → 100 swing potential (maximum contestation)
- 10% margin → 100 swing potential (capped)

### 3. Turnout Factor (20% weight)

Accounts for electoral stability. Smaller electorates are more volatile due to external factors (weather, turnout variance, organizational capacity).

- **Benchmarks:** County-level races typically see 5k-50k total votes
- **Scale:**
  - <5,000 votes → 80 (highly volatile)
  - 5k-10k votes → 60 (volatile)
  - 10k-25k votes → 40 (moderate stability)
  - 25k-50k votes → 20 (stable)
  - >50k votes → 10 (very stable)

**Rationale:** A 5% margin in a 3,000-voter race is far riskier than the same margin in a 50,000-voter race, due to:
- Smaller absolute number of swing voters needed
- Higher impact of turnout variance
- Voter groups more identifiable (easier to target)

### 4. Category Multiplier (10% weight)

Strategic classification of race type.

- **Flip Opportunity** (R winner): 1.0× multiplier
  - Democratic analysis: Races to target for flipping
- **Retention Risk** (D winner): 1.0× multiplier
  - Democratic analysis: Races at risk of losing
- **Other** (unclassified): 0.7× multiplier
  - Lower strategic priority for partisan analysis

## Final Calculation

```
composite_score = (
    margin_component × 0.40 +
    swing_potential × 0.30 +
    turnout_component × 0.20
)

final_score = composite_score × category_multiplier
final_score = clamp(final_score, 0, 100)
```

## Score Interpretation

| Score Range | Assessment | Recommended Action |
|-------------|-----------|-------------------|
| 80-100 | Extremely Vulnerable | Priority focus - immediate strategic attention |
| 60-80 | Very Vulnerable | High priority - significant resource allocation |
| 40-60 | Moderately Vulnerable | Monitor closely - consider strategic investment |
| 20-40 | Less Vulnerable | Background monitoring only |
| 0-20 | Safe | Not a strategic priority |

## Example Scenarios

### Scenario 1: Razor-Thin Margin, Moderate Electorate
- **Race:** County Supervisor
- **Margin:** 1% (500 votes)
- **Total Votes:** 10,000
- **Winner:** Republican
- **Score:** 54.0 (Moderately Vulnerable)

**Analysis:** Despite extremely tight margin, the moderate electorate size (10k) provides some stability. Still vulnerable due to margin tightness.

### Scenario 2: Moderate Margin, Very Small Electorate
- **Race:** Town Council
- **Margin:** 5% (150 votes)
- **Total Votes:** 3,000
- **Winner:** Democratic
- **Score:** 82.0 (Extremely Vulnerable)

**Analysis:** Highest score in typical scenarios. Small electorate makes even moderate margins dangerous - 150 vote swing is easily achievable through weather, organization, or turnout variance.

### Scenario 3: Same Margin, Different Electorate
- **Race A:** 5% margin, 3,000 votes → 82.0
- **Race B:** 5% margin, 50,000 votes → 68.0
- **Difference:** 14 points (19% difference)

**Analysis:** Identical margins produce very different vulnerability scores due to electorate size. Smaller races are intrinsically more volatile.

### Scenario 4: Blowout Victory
- **Race:** County Legislature
- **Margin:** 45%
- **Total Votes:** 30,000
- **Winner:** Democratic
- **Score:** 38.0 (Less Vulnerable)

**Analysis:** Large margin dominates the score despite decent turnout. Outcome is not in serious question.

## Data Categories

Races are categorized for strategic analysis:

| Category | Criteria | Strategic Use |
|----------|----------|----------------|
| **Flip Opportunity** | Republican winner, any margin | Target for Democratic strategy |
| **Retention Risk** | Democratic winner, any margin | Defend for Democratic strategy |
| **Other** | Non-D/R winner | Lower priority |

## Database Integration

**Table:** `races` and `candidates`

**Calculation Timing:**
- Scores recalculated on each data refresh
- Cached in response for frontend display
- No persistence (always computed from raw data)

**Query:** `GET /api/races/vulnerability?limit=20`
- Returns top 20 most vulnerable races by score
- Sorted descending by score (highest vulnerability first)

## Design Rationale

### Why Multi-Factor Scoring?

Single-factor scoring (e.g., margin only) misses critical context:

1. **Margin alone** ignores electorate volatility (3k voter race vs 50k voter race)
2. **Turnout alone** ignores the outcome (a 30% margin race is safe regardless of size)
3. **Composite approach** captures the full picture

### Why These Weights?

- **40% Margin:** Most predictive factor for outcome vulnerability
- **30% Swing Potential:** Secondary predictor - how many votes matter
- **20% Turnout:** Affects volatility but not deterministic
- **10% Category:** Strategic classification, not a mathematical predictor

Weights derived from:
- Election literature on swing voter density
- Turnout variance research (typically 5-10% variance year-to-year)
- Strategic campaign resource allocation patterns

## Limitations

1. **Not Predictive of Outcome:** Score reflects current vulnerability, not future performance
2. **Ignores Campaign Quality:** No factor for incumbent strength, fundraising, or organization
3. **Ignores Demographics:** No factor for population change, age cohorts, or education shifts
4. **Static Analysis:** Single election snapshot - doesn't account for trends
5. **Partisan Perspective:** Designed for Democratic strategy (can be reversed for Republicans)

## Future Enhancements

Potential improvements for future versions:

1. **Fusion Voting Integration:** Boost score for races with high minor party leverage
2. **Incumbent Strength:** Adjust for incumbent vs challenger races
3. **Demographic Trends:** Factor in population change, registration shifts
4. **Turnout History:** Use historical turnout variance to refine electorate stability
5. **Lean Shift Analysis:** Track margin changes over time to identify momentum
6. **Rolloff Analysis:** Distinguish skip rates (may indicate weakness on ballot)

## Testing

Unit tests verify scoring logic:
```bash
python3 backend/test_vulnerability_logic.py
```

Expected outputs:
- Very tight races consistently score 50-70
- Small electorates boost scores 10-15 points
- Blowouts score <40
- Category multiplier is neutral for D/R (0.7x for Other)
